---
title: 图片的懒加载和预加载
outline: [2,6]
---

# 图片的懒加载和预加载

## 懒加载

### 定义

延迟加载图片，当用户需要的时候再去加载图片

### 实现

利用自定义属性将图片的 URL 存放到图片标签身上 ， 图片的 src 为空或者用其他较小的图片资源代替（提示加载中）

图片的懒加载主要是监听 body 或者其他存放图片且滚动的元素的 scroll 事件.

在每一次事件触发时，通过相关的 API 和属性，检查图片是否显示 。

如果显示就将 URL 填到 src 属性中 ，加载图片 。如果没有显示则不进行操作。

#### 如何检测图片是否显示

- 滚动监听+scrollTop+offsetTop+innerHeight
- 滚动监听+getBoundingClientRect()
- IntersectionObserver

## 预加载

### 定义

提前加载图片，当用户需要查看时可直接从本地缓存中渲染。

### 实现

- 使用 css 属性，将 img 标签移到看不到或者缩小到看不到，但不能使用display:none。 使用到已经预加载好的图片时，会直接使用缓存好的图片资源，而不需要向服务器发送请求
- 创建一个 image 对象 new Image() 。将 image 对象的 src 属性的值指定为预加载图片的 URL
